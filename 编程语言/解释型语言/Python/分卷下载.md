> [!BUG] 分卷下载蓝奏云超出 100 MB 文件，下载后并自动重命名自动解压并删除源文件

```Python
import os
import requests
from tqdm import tqdm
import patoolib
import glob
import time

myD = {1: 'a', 2: 'b'}
for key, value in dict.items(myD):
    print()

# 文件下载链接列表
file_urls = [
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iuquq1z103yf&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/irg5H1z0zzre&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/i7BdR1z109he&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/icmMa1z1166b&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/idUUV1z10zng&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/i0PwU1z15nlc&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iDHiq1z11q4j&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iXTsr1z11lni&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/i7Zei1z11hvc&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/ihHGv1z11dvi&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/i5zeE1z128ud&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/i3duJ1z124mb&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/imYXl1z1211c&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iISY61z11vyj&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/ielha1z12tpe&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/ibGfo1z12p3i&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iX3eB1z12kwh&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/i5gye1z12i0d&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iaT451z133va&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/inKzE1z12zkf&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/irfuk1z13rle&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/i5z6C1z13ksj&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iiLOu1z13ffg&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iyL0p1z13bna&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/ipusO1z1389i&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iEKgv1z1590h&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/i0tBM1z14uhe&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iu8881z14q8b&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iPUj61z14ldg&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iDGQs1z14gdg&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/i7i0W1z148ni&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iTImh1z155oh&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iqkTp1z152ej&type=down',
    'https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iQi2F1z15c1g&type=down',
]
print("MS Office 2024 下载脚本 @ASLant")
print("更多资源请访问 : aslant.top")
time.sleep(1)
print("下载地址为当前路径下downloads文件夹内")
print("需下载文件共计34个，总计文件大小3.7GB，文件即将开始下载")
time.sleep(3)
print("开始下载")

# 保存文件的目录
save_dir = './downloads/'

# 确保保存目录存在
os.makedirs(save_dir, exist_ok=True)

for i, url in enumerate(file_urls, start=1):
    # 获取文件名
    file_name = url.split('/')[-1]

    # 下载文件并显示进度条
    response = requests.get(url, stream=True)
    total_size = int(response.headers.get('content-length', 0))
    block_size = 1024  # 1 KB
    progress_bar = tqdm(total=total_size, unit='B', unit_scale=True, desc=f'Downloading {file_name}')
    with open(os.path.join(save_dir, file_name), 'wb') as file:
        for data in response.iter_content(block_size):
            progress_bar.update(len(data))
            file.write(data)
    progress_bar.close()

    # 构造新文件名
    new_file_name = f"Office.part{i:02d}.rar"
    new_file_path = os.path.join(save_dir, new_file_name)

    # 重命名文件
    os.rename(os.path.join(save_dir, file_name), new_file_path)
    print(f"Downloaded and renamed: {file_name} -> {new_file_name}")

# 获取所有分卷压缩文件
rar_files = sorted(glob.glob(os.path.join(save_dir, 'Office.part*.rar')))

# 解压第一个分卷，patoolib 会自动找到并解压所有分卷
if rar_files:
    first_rar = rar_files[0]
    print(f"Extracting {first_rar}")
    patoolib.extract_archive(first_rar, outdir=save_dir)

    # 删除所有分卷压缩文件
    for rar_file in rar_files:
        os.remove(rar_file)
        print(f"Deleted: {rar_file}")

print("解压成功，请双击./Downloads文件夹下  右键管理员安装.cmd ")
time.sleep(30)
```

> [!BUG] [Download](https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/izIwu1z2smod&type=down)
