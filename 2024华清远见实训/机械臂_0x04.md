[[../ASLant_Files/1bbaf869c0848a2b12b6beae01f23b10_MD5.jpg|Open: 1bbaf869c0848a2b12b6beae01f23b10_MD5.jpg]]
# 2024.05.23 华清远见实训日报

# ADC 模拟量采集电压值，输出到串口

###  CUBEMX 配置

![[../ASLant_Files/7672277851f428fe25b93fee52f6c7fb_MD5.jpg]]

### 代码
###### 变量声明
```c
uint16_t ADC_Value;
```

###### Main 中
```c
MX_ADC1_Init();//之后添加
HAL_ADCEx_Calibration_Start(&hadc1);    //AD校准
```

###### While (1) 中
```c
HAL_ADC_Start(&hadc1);     //启动ADC转换
HAL_ADC_PollForConversion(&hadc1, 50);   //等待转换完成，50为最大等待时间，单位为ms

if(HAL_IS_BIT_SET(HAL_ADC_GetState(&hadc1), HAL_ADC_STATE_REG_EOC))
 {
  ADC_Value = HAL_ADC_GetValue(&hadc1);   //获取AD值
  printf("ADC value : %.4f \r\n",ADC_Value*3.3f/4096);
  printf("十组\r\n");
}
HAL_Delay(1000);
```

### 效果
<video src="https://s138.ananas.chaoxing.com/sv-w8/video/32/ec/1a/ec1a022f0b660185cfe4d0b644dcd1af/sd.mp4" width="100%" height="100%" controls="controls" class="rounded-video"></video>

# 接收重定向

> [!BUG] 需包括 stdio.h 头文件
### 代码

While（1）中
```c
scanf("%s",(uint8_t *)&Buff);
printf("%s",Buff);
printf("\r\n");
```

Main 函数之外
```c
int fgetc(FILE *f)
{
    int c;
    while(!(USART1->SR&(1<<5)));
    c=USART1->DR;
    return c;
}
```

### 效果
<video src="https://s138.ananas.chaoxing.com/sv-w7/video/6f/ed/3b/89a6511b4eba5af06a070d2c40a4d05f/sd.mp4" width="100%" height="100%" controls="controls" class="rounded-video"></video>

# 今日源代码

> [!BUG] 下载
> [源代码下载](https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iZSuj1zjfzcd&type=down)
> [Xcom串口助手](https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iIQhS1zjg44f&type=down)
> 
![[ASLant_Images/1bbaf869c0848a2b12b6beae01f23b10_MD5.jpg]]
[](../ASLant_Files/1bbaf869c0848a2b12b6beae01f23b10_MD5.jpg)[[ASLant_Images/1bbaf869c0848a2b12b6beae01f23b10_MD5.jpg|Open: 1bbaf869c0848a2b12b6beae01f23b10_MD5.jpg]]
# 2024.05.23 华清远见实训日报

# ADC 模拟量采集电压值，输出到串口

###  CUBEMX 配置

![[ASLant_Images/7672277851f428fe25b93fee52f6c7fb_MD5.jpg]]

### 代码
###### 变量声明
```c
uint16_t ADC_Value;
```

###### Main 中
```c
MX_ADC1_Init();//之后添加
HAL_ADCEx_Calibration_Start(&hadc1);    //AD校准
```

###### While (1) 中
```c
HAL_ADC_Start(&hadc1);     //启动ADC转换
HAL_ADC_PollForConversion(&hadc1, 50);   //等待转换完成，50为最大等待时间，单位为ms

if(HAL_IS_BIT_SET(HAL_ADC_GetState(&hadc1), HAL_ADC_STATE_REG_EOC))
 {
  ADC_Value = HAL_ADC_GetValue(&hadc1);   //获取AD值
  printf("ADC value : %.4f \r\n",ADC_Value*3.3f/4096);
  printf("十组\r\n");
}
HAL_Delay(1000);
```

### 效果
<video src="https://s138.ananas.chaoxing.com/sv-w8/video/32/ec/1a/ec1a022f0b660185cfe4d0b644dcd1af/sd.mp4" width="100%" height="100%" controls="controls" class="rounded-video"></video>

# 接收重定向

> [!BUG] 需包括 stdio.h 头文件
### 代码

While（1）中
```c
scanf("%s",(uint8_t *)&Buff);
printf("%s",Buff);
printf("\r\n");
```

Main 函数之外
```c
int fgetc(FILE *f)
{
    int c;
    while(!(USART1->SR&(1<<5)));
    c=USART1->DR;
    return c;
}
```

### 效果
<video src="https://s138.ananas.chaoxing.com/sv-w7/video/6f/ed/3b/89a6511b4eba5af06a070d2c40a4d05f/sd.mp4" width="100%" height="100%" controls="controls" class="rounded-video"></video>

# 今日源代码

> [!BUG] 下载
> [源代码下载](https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iZSuj1zjfzcd&type=down)
> [Xcom串口助手](https://www.yuanxiapi.cn/api/lanzou/?url=https://aslant.lanzoul.com/iIQhS1zjg44f&type=down)
> 
![[ASLant_Images/1bbaf869c0848a2b12b6beae01f23b10_MD5.jpg]]





